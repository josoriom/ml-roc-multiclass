/* Predictions R obtaine with OPLS from Metabom8 using iris dataset
library(pROC)
*/

import largeDataset from '../../data/large-test.json';
import { getAuc } from '../getAuc';
import { getRocCurve } from '../getRocCurve';

describe('Testing results against pPROC R library', () => {
  /*
    large_prediction <- c(1.0365452297959115, 0.8493060370571008, 1.0342037731886458, 0.9880274270163336, 1.1636450776935392, 1.084491069427696, 0.8957554049558211, 0.8138280636647499, 0.9568713340826936, 1.1691252470955729, 1.1821149581732393, 1.130888452279038, 0.8533555517763516, 1.145228537372359, 1.1883827221166228, 0.8722773093987777, 0.8343293076684034, 0.8063397049378358, 1.0867129159226872, 1.0046942801105523, 1.0577051242791884, 1.0869649061510605, 1.095254883112449, 0.9348666364431293, 0.9907769949630663, 0.8040728179412099, 1.116083178442569, 1.1667660300465659, 0.9631010190725986, 1.1028849249708432, 0.9333879465039019, 0.933581674466139, 0.9429748228989319, 1.9496454867032953, 2.069217140979616, 1.8258866733117425, 1.9293382134487478, 1.9442930277548645, 2.1154374494213677, 2.1886943544220046, 1.8271613657946937, 2.171276093318114, 2.0237333036609666, 2.1126807530761504, 1.913718846424655, 2.1727086272694462, 1.8396931050637382, 1.8059333779177045, 2.150333928059235, 2.0337886077156986, 2.11691831340615, 1.8156138104750785, 2.0809063168083375, 2.0385985438786385, 2.0577014236897075, 1.9218394967989347, 2.1513556975475057, 1.9477217651313303, 1.856117516336013, 1.9200298878724311, 1.8017685141603978, 2.0057376769112008, 1.9323933523547496, 2.1472698229070595, 1.9916799516121986, 1.834060654253912, 2.8228295985587293, 3.08519996066406, 3.069759277392812, 3.006983643463387, 3.015520841107048, 3.1949477645240436, 2.9125541324044844, 3.0750642785381896, 2.910920226386955, 3.1641924440646623, 2.9123195603565173, 2.8468571996392025, 2.9350716614029455, 3.158919891385074, 3.1675098584875805, 2.9275375066543523, 2.8780018589000074, 2.9935266069480226, 3.1024476306327045, 2.9563025215514425, 2.984452859234479, 2.9530560709426217, 3.00745952487802, 2.9169358581101963, 3.0257947144234945, 3.0179959449574434, 3.072373805445354, 2.982183614615615, 2.962472855522855, 3.1422338858981105, 2.862648514824194, 3.027693290012354, 2.9148150892651783)
    large_classes <- c('class1', 'class1', 'class1', 'class1', 'class1', 'class1', 'class1', 'class1', 'class1', 'class1', 'class1', 'class1', 'class1', 'class1', 'class1', 'class1', 'class1', 'class1', 'class1', 'class1', 'class1', 'class1', 'class1', 'class1', 'class1', 'class1', 'class1', 'class1', 'class1', 'class1', 'class1', 'class1', 'class1', 'class2', 'class2', 'class2', 'class2', 'class2', 'class2', 'class2', 'class2', 'class2', 'class2', 'class2', 'class2', 'class2', 'class2', 'class2', 'class2', 'class2', 'class2', 'class2', 'class2', 'class2', 'class2', 'class2', 'class2', 'class2', 'class2', 'class2', 'class2', 'class2', 'class2', 'class2', 'class2', 'class2', 'class3', 'class3', 'class3', 'class3', 'class3', 'class3', 'class3', 'class3', 'class3', 'class3', 'class3', 'class3', 'class3', 'class3', 'class3', 'class3', 'class3', 'class3', 'class3', 'class3', 'class3', 'class3', 'class3', 'class3', 'class3', 'class3', 'class3', 'class3', 'class3', 'class3', 'class3', 'class3', 'class3')
    large_auc <- multiclass.roc(response = large_classes, predictor = large_prediction, plot = TRUE)
    */
  it('Random large dataset of 3 classes successful with prediction0', () => {
    const auc0 = getAuc(
      getRocCurve(largeDataset.classes, largeDataset.prediction0),
    );
    /*
    Data: large_prediction with 3 levels of large_classes: class1, class2, class3.
    Multi-class area under the curve: 1
    */
    expect(auc0).toBeCloseTo(1.0, 4);
  });

  /*
    large_prediction <- c(1.0289822964647586, 1.0978350415388471, 0.8610526582254995, 1.0423958306535377, 1.0176658733738868, 0.8184852651734511, 0.9161375423496608, 1.1962068908076162, 0.8816848523027722, 0.9772565708760508, 1.0208240882300612, 1.0806612163298732, 3.0330145598995792, 3.006947518899378, 3.184980626253225, 0.8863366357230127, 0.9928458543322096, 0.8674359513462472, 3.184418447453429, 3.1759869559554232, 3.1904937265999798, 0.9306748914996757, 0.8981577604038901, 0.9255825633508042, 0.8304030653033437, 1.0420514989206613, 1.1511267381053285, 1.9875999916819524, 1.8110747987434603, 1.9134110554262538, 0.9764179214918957, 1.0568779232550143, 0.9311185612144628, 1.8762751473783463, 2.025094649793155, 2.0328577141920117, 2.1372097884949444, 1.9460058748071807, 2.190797826785991, 2.0069357460581245, 2.0451137011313008, 2.1770702797890698, 2.0808114465706677, 2.160259849668218, 1.9285597815060394, 2.1289837074198203, 1.9768362972704139, 1.9177513556528403, 2.0444191288414184, 2.0505068524526955, 1.8531377371841804, 0.8663258224985919, 1.1455291599117239, 0.933990119306613, 1.890284464935513, 2.1597811503566935, 2.1184182204796915, 1.8512696767889791, 1.9796367931982972, 1.8597105242438567, 1.9983036119807023, 1.8414177064530244, 2.0992390088566575, 1.9023031660324543, 1.855649989360082, 2.0339054568378088, 3.1790622362339205, 3.0656895542751936, 3.0031934191647585, 2.939124605254343, 2.940869784571577, 3.1706016030260225, 2.8813242679543416, 2.987474521779794, 3.0556195200300253, 3.0386832856826578, 3.164413491334521, 2.944139393750571, 3.111864826561923, 3.0509069076251567, 3.03736324029368, 2.87410159559355, 3.1778744357317663, 2.807142069535537, 2.8198412391901986, 2.839456323045589, 0.8696643585037677, 0.9126425891489972, 0.8031825256619782, 1.0713916099605154, 1.07516730692306, 1.1949375095610923, 3.1442036901924793, 3.0212970929610146, 2.8613727790627244, 3.0942108196539877, 2.9321632295097597, 2.883273261335189, 2.9493169900603182)
    large_classes <- c('class1', 'class1', 'class1', 'class1', 'class1', 'class1', 'class1', 'class1', 'class1', 'class1', 'class1', 'class1', 'class1', 'class1', 'class1', 'class1', 'class1', 'class1', 'class1', 'class1', 'class1', 'class1', 'class1', 'class1', 'class1', 'class1', 'class1', 'class1', 'class1', 'class1', 'class1', 'class1', 'class1', 'class2', 'class2', 'class2', 'class2', 'class2', 'class2', 'class2', 'class2', 'class2', 'class2', 'class2', 'class2', 'class2', 'class2', 'class2', 'class2', 'class2', 'class2', 'class2', 'class2', 'class2', 'class2', 'class2', 'class2', 'class2', 'class2', 'class2', 'class2', 'class2', 'class2', 'class2', 'class2', 'class2', 'class3', 'class3', 'class3', 'class3', 'class3', 'class3', 'class3', 'class3', 'class3', 'class3', 'class3', 'class3', 'class3', 'class3', 'class3', 'class3', 'class3', 'class3', 'class3', 'class3', 'class3', 'class3', 'class3', 'class3', 'class3', 'class3', 'class3', 'class3', 'class3', 'class3', 'class3', 'class3', 'class3')
    large_auc <- multiclass.roc(response = large_classes, predictor = large_prediction, plot = TRUE)
    */
  it('Random large dataset of 3 classes with prediction1', () => {
    const auc1 = getAuc(
      getRocCurve(largeDataset.classes, largeDataset.prediction1),
    );
    /*
    Data: large_prediction with 3 levels of large_classes: class1, class2, class3.
    Multi-class area under the curve: 0.7821
    */
    expect(auc1).toBeCloseTo(0.7821, 4);
  });

  /*
    large_prediction <- c(0.9883424249284287, 1.0582887653845041, 0.8736449217231693, 1.0704761578624316, 0.9012979870543947, 1.072854245348207, 3.033717649762721, 3.164242030550173, 3.0722651397277883, 3.0167127992147345, 3.053729082445515, 2.9942542233520966, 0.9478214883593437, 1.0789169483367231, 1.042292903186083, 0.9188338945832084, 1.0591066097437514, 0.8038410148907225, 0.9007011368548921, 0.9323741478377062, 0.968232750777484, 1.0629496856322374, 1.1777670953712471, 0.9430867675921368, 0.8975233354113881, 0.8347442842596968, 0.9335098022861164, 1.0265120900651767, 0.8830309362428362, 0.9730971714686211, 1.1464495432225321, 1.1076319440386384, 0.9662607407546762, 1.9500459102081118, 1.9089239269216274, 1.8654578708731204, 2.1321787701531205, 2.187138273328651, 1.9531326415699553, 2.1380292083275068, 2.093667459794833, 1.832656691830583, 2.0212667052692357, 1.8148018151545418, 2.098828612946913, 1.996146192344878, 2.1399447968873027, 1.9367411113547022, 2.023168807638092, 2.078727511000357, 2.180545559384174, 2.067747398225565, 1.8027406858440678, 2.1783065483958826, 2.1405860502544374, 2.1832841811071906, 2.139165685631566, 2.1399773578685815, 1.1523534804504096, 1.0934385755893994, 0.8468073978508086, 1.0913044505454885, 1.0537866126684416, 1.0755412415336345, 2.0776648135345943, 2.1539615009449173, 2.8662452923775112, 2.949485091730761, 2.804581902758615, 2.844983303837352, 3.0950734442074244, 3.189589707789825, 3.0806218605659605, 2.9933837981976934, 1.956128520408756, 2.031345709871699, 1.8462509115186168, 1.8931673381876752, 1.9506893765718565, 2.1523301472287684, 3.0629684668942283, 3.168887053436089, 2.895476983720722, 3.093236275511466, 2.804044080554696, 2.9732777997566044, 3.027145909736929, 2.868532124981317, 2.9580817162405726, 3.1049835945952124, 2.977678339120832, 2.8097580769512445, 3.170150070530719, 2.8652662640662485, 2.906766963276127, 2.8052389828109154, 2.8178267144412095, 2.9764096008294207, 3.185933711648308)
    large_classes <- c('class1', 'class1', 'class1', 'class1', 'class1', 'class1', 'class1', 'class1', 'class1', 'class1', 'class1', 'class1', 'class1', 'class1', 'class1', 'class1', 'class1', 'class1', 'class1', 'class1', 'class1', 'class1', 'class1', 'class1', 'class1', 'class1', 'class1', 'class1', 'class1', 'class1', 'class1', 'class1', 'class1', 'class2', 'class2', 'class2', 'class2', 'class2', 'class2', 'class2', 'class2', 'class2', 'class2', 'class2', 'class2', 'class2', 'class2', 'class2', 'class2', 'class2', 'class2', 'class2', 'class2', 'class2', 'class2', 'class2', 'class2', 'class2', 'class2', 'class2', 'class2', 'class2', 'class2', 'class2', 'class2', 'class2', 'class3', 'class3', 'class3', 'class3', 'class3', 'class3', 'class3', 'class3', 'class3', 'class3', 'class3', 'class3', 'class3', 'class3', 'class3', 'class3', 'class3', 'class3', 'class3', 'class3', 'class3', 'class3', 'class3', 'class3', 'class3', 'class3', 'class3', 'class3', 'class3', 'class3', 'class3', 'class3', 'class3')
    large_auc <- multiclass.roc(response = large_classes, predictor = large_prediction, plot = TRUE)
    */
  it('Random large dataset of 3 classes with prediction2', () => {
    const auc2 = getAuc(
      getRocCurve(largeDataset.classes, largeDataset.prediction2),
    );
    /*
    Data: large_prediction with 3 levels of large_classes: class1, class2, class3.
    Multi-class area under the curve: 0.8476
    */
    expect(auc2).toBeCloseTo(0.8476, 4);
  });
});
